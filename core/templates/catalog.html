{% extends "base.html" %}

{% block title %}Equipment Catalog{% endblock %}

{% block content %}
  <h1 class="mb-4">Equipment Catalog</h1>

  <!-- Show "Add New Equipment" only to librarians -->
  {% if user.is_authenticated and user.profile.is_librarian %}
    <p>
      <a class="btn btn-success mb-3" href="{% url 'core:add_equipment' %}">Add New Equipment</a>
    </p>
  {% endif %}

  <ul class="list-unstyled">
    {% for item in items %}
      <li class="mb-5 border-bottom pb-3">
        <h4>{{ item.name }}</h4>
        <div class="mb-2">
          {% for image_obj in item.images.all %}
            <img src="{{ image_obj.image.url }}" alt="{{ item.name }}" width="150" class="img-thumbnail me-2">
            {% if image_obj.caption %}
              <p>{{ image_obj.caption }}</p>
            {% endif %}
          {% empty %}
            <em>No images available</em>
          {% endfor %}
        </div>
        <p>
          {% if item.is_available %}
            Status: <span class="text-success">Available</span>
          {% else %}
            Status: <span class="text-danger">Loaned Out</span>
          {% endif %}
        </p>
        <!-- Show "Add Image" only to librarians -->
        {% if user.is_authenticated and user.profile.is_librarian %}
          <p>
            <a class="btn btn-secondary" href="{% url 'core:add_item_image' item.id %}">Add Image</a>
          </p>
        {% endif %}
      </li>
    {% endfor %}
  </ul>

  <a class="btn btn-link" href="{% url 'core:home' %}">Back to Home</a>
{% endblock %}
